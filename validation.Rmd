# 가설 검정

### 카이제곱 검정

두 범주형 변수(카테고리)가 서로 상관이 있는지 판단하는 통계적 검정 방법

#### 아이들의 장난감 보유 현황

-   귀무가설: 아이들의 장난감 보유수에 대한 만족도는 차이가 없다.

-   대립가설: 아이들의 장난감 보유수에 대한 만족도의 차이가 있다.

```{r}
child1=c(5,11,1)
child2=c(4,7,3)
toy=cbind(child1,child2)
toy
```

```{r}
rownames(toy)=c("car","doll","chess");toy
```

카이제곱 검정 실시

```{r}
chisq.test(toy) #모든 신뢰구간은 95%
```

결론

p-value=0.4219\>0.05(95% 신뢰구간): 귀무가설 채택

즉, child1과 child2의 데이터는 통계적으로 큰 차이가 없다.

p-value가 유의수준보다 작으면 대립가설을, 유의수준보다 크면 귀무가설을 채택한다.

그런데...

Warning: 카이제곱의 근사값이 정확하지 않을 수 있다. -\>데이터량이 적은 경우 발생(At least 15 data needed)

그렇다면...

피셔 검정: 표본 수가 적거나 데이터의 분포가 치우친 경우

```{r}
fisher.test(toy)
```

```{r}
cor(child1,child2)
```

## T검정

귀무가설: 건전지의 수명은 1000시간이다.

대립가설: 건전지의 수명은 1000시간이 아니다.

1.  데이터의 분포가 정규 분포: Shapiro-Wiik 검정

    1.  귀무가설: 자료가 정규분포를 따른다.

    2.  대립가설: 자료가 정규분포를 따르지 않는다.

```{r}
bat=c(980,1008,968,1032,1012,1002,996,1017)
shapiro.test(bat)
```

p-value를 보면 정규분포

```{r}
t.test(bat,mu=1000,alternative="two.sided")
```

alternative

two.sided: 데이터의 평균과 다르다

greater: 데이터가 평균보다 크다

less: 데이터가 평균보다 작다

p-value=0.8032\>0.05: 귀무가설(건전지의 수명은 1000시간이다)

어떤 학교의 수학 점수 평균: 55점

0교시 수업을 한 후에 학생들의 성적이 올랐을까?

귀무가설: 성적은 오르지 않았다.

대립가설: 성적이 올랐다.

```{r}
exam=read.csv("exam.csv");head(exam)
```

```{r}
shapiro.test(exam$score)
```

시험 점수는 정규분포를 이룬다. 그렇다면 평균을 구해 보자.

```{r}
mean(exam$score)
```

분명히 시험 점수가 올랐다! 하지만 사실일까?

```{r}
summary(exam$score)
```

99점이 이상치가 아닐까?

```{r}
boxplot(exam$score)
```

```{r}
t.test(exam$score,mu=55,alternative="greater")
```

p-value=0.4046\>0.05: 귀무가설 채택 -\> 성적은 오르지 않았다.

# 상관관계

```{r}
y=c(2,1,4,3)
y2=c(1,2,3,4)
z=c(0,5,7,9)
cor(y,z)
cor(y2,z) #상관관계는 순서가 중요하다.
cor(y2,z,method="spearman")
```

```{r}
cor(y,z,method="pearson") #Default
cor(y,z,method="spearman") #More accurate with less than 15 data
```

# 콜모고로프-스미노프 검정(KS Test)

주어진 2개의 데이터가 같은 분포인지 다른 분포인지 검정

귀무가설: 두 개의 데이터 분포가 다르다.

대립가설: 두 개의 데이터 분포가 같다.

```{r}
x=rnorm(50)
y=runif(50)
ks.test(x,y)
```

p-value가 0.05보다 작음: 두 개는 같은 분포

# 부호검정

두 개의 데이터 사이에 차이가 있는지 검정

귀무가설: 유의한 차이가 없다.

대립가설: 유의한 차이가 있다.

식사 전과 후의 음료수 맛에 대한 평가(5점 만점)

```{r}
x=c(4,1,1,4,3,3,2,5,3,3)
y=c(1,1,3,2,5,1,4,4,3,1)
```

```{r}
binom.test(c(length(x[x>y]),length(x[x<y])))
```

p-value\>0.05이므로 귀무가설 채택

# 비율 검정

2개의 데이터 사이에 비율의 차이가 있는지 없는지 검정

맥주를 좋아하시나요? 라는 질문에 서울에서는 400명 중 360명이, 부산에서는 200명 중 136명이 좋다고 답했다면 둘의 비율 차이가 있다고 할 수 있는가?

귀무가설: 유의한 차이가 없다.

대립가설: 유의한 차이가 있다.

```{r}
beer=c(360,136)
sample=c(400,200)
prop.test(beer,sample)
```

p-value가 0.05보다 작으므로 대립가설 채택: 유의한 차이가 있다.
